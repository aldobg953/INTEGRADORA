<!DOCTYPE html>
<html>
<head>
    <link rel="icon" href="css/IsotipoPathFinderTabIcon.ico" type="image/x-icon">

    <title th:text="#{carreraa}">PathFinder | Carrera</title>
    <link href="/css/tailwind.css" rel="stylesheet">
    <script src="/js/navbar.js"></script>
    <link rel="stylesheet" href="/css/carrera.css">
    <link rel="stylesheet" href="/css/validaciones.css">
</head>
<body class="dark:bg-gray-800">
    
    <header class="header">
        <nav class="navbar">
            <div class="navbar-logo">
                <a th:href="@{/}">
                    <img src="/css/LogoLogoPathFinderHorizontal.svg" alt="" id="navbar-logo">
                </a>
                <hr>

                <a th:href="@{/universidades?lang=}+${usuario.lang}" style="display: yes;"><div class="link"><img src="/css/assets/navbaricons/universidad.png" alt="" class="link-icon" th:text="#{universidades}"></div></a>
                <a th:href="@{/carreras/areas?lang=}+${usuario.lang}" style="display: yes;"><div class="link"><img src="/css/assets/navbaricons/area.png" alt="" class="link-icon" th:text="#{areas}"></div></a>
                <a th:href="@{/carreras/all?lang=}+${usuario.lang}" style="display: yes;"><div class="link"><img src="/css/assets/navbaricons/gorro.png" alt="" class="link-icon" th:text="#{carreras}"></div></a>
            </div>

            <div class="navbar-links" id="navbarLinks">

                <div class="form-input ">
                    <span class="input-icon"><i class="fi fi-rr-sparkles"></i></span>
                    <input type="text" id="search-bar" th:placeholder="#{mensajeBarraBusqueda}">
                </div>

                <hr>
                <a th:href="@{/configuracion/perfil?lang=}+${usuario.lang}" style="display: yes;">
                    <div class="link"><img th:src="@{'/img/perfilUsuario/' + ${usuario.foto_perfil} + '.jpg'}" alt="" id="profile-icon"
                            class="link-icon" th:text="#{perfil}"></div>
                </a>
            </div>

        </nav>
    </header>

    <div id="dynamicBackground" th:data-background-image="@{'/img/' + ${carrera.universidad.nombre_abreviado} + '/portada.jpg'}" class="bg-fixed w-full min-h-80 bg-cover" style="background-position: center 70%;">
        <div class="bg-sky-900 w-full h-72 flex items-center justify-center bg-opacity-50">
            <span class="font-serif text-5xl text-white font-bold z-10 ml-12 text-center" th:text="${carrera.nombre}">nombre_completo</span>
        </div>
        <div class="bg-sky-900 w-full flex items-center justify-end bg-opacity-50">
            <!-- Botón para agregar a favoritos -->
            <form th:if="${carrera.esFavoritaParaUsuario(usuario)}" 
                th:action="@{/carreras/carreras/quitarFav}" 
                method="post">
            <input type="hidden" name="carreraId" th:value="${carrera.id_carrera}" />
            <button type="submit">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <path d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z" />
                </svg>
                Favoritos
            </button>
            </form>

            <form th:if="${!carrera.esFavoritaParaUsuario(usuario)}" 
                th:action="@{/carreras/carreras/agregarFav}" 
                method="post">
                <input type="hidden" name="carreraId" th:value="${carrera.id_carrera}" />
                <button type="submit">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M3.172 5.172a4 4 0 015.656 0L12 8.343l3.172-3.171a4 4 0 115.656 5.656L12 19.657l-8.828-8.829a4 4 0 010-5.656z" />
                    </svg>
                    Favoritos
                </button>
            </form>
        </div>
    </div>
    
    <script th:inline="javascript">
        document.addEventListener('DOMContentLoaded', function() {
            var elemento = document.getElementById('dynamicBackground');
            var imagenFondo = /*[[${'/img/' + carrera.universidad.nombre_abreviado + '/portada.jpg'}]]*/ 'default-image.jpg';
            
            if (imagenFondo) {
                elemento.style.backgroundImage = 'url("' + imagenFondo + '")';
            }
        });
    </script>

    <div class="main-content dark:bg-gray-800">

    <div class="carrera-acercade">
        <div class="vertical-line"></div>
        <p th:text="${carrera.informacion}"></p>
    </div>

    <div class="logo-informacion">
        <div class="logo-carrera">
            <img th:src="@{'/img/' + ${carrera.universidad.nombre_abreviado} + '/logo.jpg'}">
        </div>

        <div class="informacion-carrera dark:bg-gray-800 dark:border-gray-700 dark:shadow-none">

            <h2 th:text="#{infoCarrera}">Informacion de la carrera</h2>

            <div>
                <h3 th:text="#{horariosCostos}">Horarios</h3>
                <p th:utext="${carrera.horario_especifico}">horario</p>
            </div>
            
            <div>
                <h3>Costo de la carrera:</h3>
                <p th:text="${carrera.costo} + '0$' + ' *por periodo'" ></p> 
            </div>
            
            <div>
                <h3 th:text="#{modalidad}">Modalidad</h3>
                <p th:text="${carrera.modalidad.nombre_modalidad}">modalidad</p>
            </div>
            
            <div>
                <h3>Periodos</h3>
                <div th:text="${carrera.cantidad_periodos} + ' ' +${carrera.periodoEscolar.nombre_periodo} + 's'">nombre_periodo</div>
            </div>
            
            <div>
                <h3 th:text="#{areas}"></h3>
                <a th:text="${carrera.area.nombre_area}" th:href="@{/carreras/area/{id}(id=${carrera.area.id_area}, lang=${usuario.lang})}"></a>
            </div>
            
            <div>
                <h3 th:text="#{universidad}"></h3>
            <a th:text="${carrera.universidad.nombre_completo}" th:href="@{/universidades/universidad/{id}(id=${carrera.universidad.id_universidad}, lang=${usuario.lang})}"></a>
            </div>
            
        </div>
    </div>
    
    <div class="por-que-estudiar">
        <div class="por-que-estudiar-text">
            <h2 th:text="'¿Por qué estudiar ' + ${carrera.nombre} + '?'">carrera</h2><br/>
            <p th:text="${carrera.porque_estudiar}">texto porque estudiar esta carrera</p>
        </div>
        <div class="por-que-estudiar-img">
            <img th:src="@{'/img/carreras/' + ${carrera.id_carrera} + '.jpg'}">
        </div>
    </div> 
    
    <div class="trabajo-desempeno">
        <div class="donde-trabajar">
            <h2 th:text="#{dondeTrabajar}"> ¿Donde puedo trabajar?</h2><br/>
            <p th:text="${carrera.donde_trabajar}"></p>
        </div>

        <div class="desempeno">
            <h2 th:text="#{comoDes}"> ¿Cómo puedo Desempeñarme?</h2><br/>
            <div><ul th:utext="${carrera.como_desemp}"></ul></div>
        </div>
    </div>

    <div th:if="${!#lists.isEmpty(especialidades)}">
        <div><p th:text="#{especialidadess}">Especialidades</p></div>
        <div th:each="especialidad:${especialidades}">
            <a th:href="@{/carreras/especialidad/{id}(id=${especialidad.id_especialidad}, lang=${usuario.lang})}">
                <img src="/img/utch/logo.jpg" alt="" />
            </a>
            <div>
                <a th:href="@{/carreras/especialidad/{id}(id=${especialidad.id_especialidad}, lang=${usuario.lang})}">
                    <h5 th:text="${especialidad.nombre}">Noteworthy technology acquisitions 2021</h5>
                </a>
                <p th:text="${especialidad.descripcion_breve}">descripcion breve</p>
                <a th:href="@{/carreras/especialidad/{id}(id=${especialidad.id_especialidad}, lang=${usuario.lang})}" th:text="#{verMas}">
                    Ver mas
                    <svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 10">
                        <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M1 5h12m0 0L9 1m4 4L9 9"/>
                    </svg>
                </a>
            </div>
        </div>
    </div>

    <div th:if="${#lists.isEmpty(especialidades)}" class="roadmap">

            <h2 th:text="#{planEstudio}">Plan de estudio </h2>

            <iframe th:src="${carrera.roadmap}" frameBorder="0"></iframe>

    </div>

    
    <div class="seccion-comentarios">
        <div class="calificaciones">
            <h2 th:text="#{calificacionesUsuarios}"></h2>
            <div>
                <div class="promedio-estrellas">
                    <span th:each="i : ${#numbers.sequence(1, 5)}">
                        <svg class="estrella" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28">
                            <path th:attr="fill=${i} <= ${califGnral.promedioGral} ? '#0047FF' : 'none', stroke=${i} <= ${califGnral.promedioGral} ? '#0047FF' : '#0047FF'"
                            d="M1.327,12.4,4.887,15,3.535,19.187A3.178,3.178,0,0,0,4.719,22.8a3.177,3.177,0,0,0,3.8-.019L12,20.219l3.482,2.559a3.227,3.227,0,0,0,4.983-3.591L19.113,15l3.56-2.6a3.227,3.227,0,0,0-1.9-5.832H16.4L15.073,2.432a3.227,3.227,0,0,0-6.146,0L7.6,6.568H3.231a3.227,3.227,0,0,0-1.9,5.832Z" />
                        </svg>
                    </span>
                    <span class="promedio-valor" th:text="${califGnral.promedioGral} + ' de 5'"></span>
                </div>
                <p class="total-calificaciones" th:text="${califGnral.cantidadCalif} + ' usuarios han calificado esta carrera'"></p>
            </div>
            <div class="barras-calificacion">
                <div class="barra" th:each="i : ${#numbers.sequence(5, 1, -1)}">
                    <div class="barra-numero">
                        <span th:text="${i}"></span>
                        <svg class="estrella" xmlns="http://www.w3.org/2000/svg" fill="#0047FF" viewBox="0 0 24 24" stroke="#0047FF">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M1.327,12.4,4.887,15,3.535,19.187A3.178,3.178,0,0,0,4.719,22.8a3.177,3.177,0,0,0,3.8-.019L12,20.219l3.482,2.559a3.227,3.227,0,0,0,4.983-3.591L19.113,15l3.56-2.6a3.227,3.227,0,0,0-1.9-5.832H16.4L15.073,2.432a3.227,3.227,0,0,0-6.146,0L7.6,6.568H3.231a3.227,3.227,0,0,0-1.9,5.832Z" />
                        </svg>
                    </div>
                    <div class="barra-progreso">
                        <div class="barra-progreso-llena" th:style="'width: ' + ${
                            i == 5 ? califGnral.promCincoE :
                            i == 4 ? califGnral.promCuatroE :
                            i == 3 ? califGnral.promTresE :
                            i == 2 ? califGnral.promDosE :
                            califGnral.promUnaE
                        } + '%'"></div>
                    </div>
                    <div class="barra-porcentaje">
                        <span th:text="${
                            i == 5 ? califGnral.promCincoE :
                            i == 4 ? califGnral.promCuatroE :
                            i == 3 ? califGnral.promTresE :
                            i == 2 ? califGnral.promDosE :
                            califGnral.promUnaE
                        } + '%'"></span>
                    </div>
                </div>
            </div>

            <form id="comentarioForm" class="formulario-comentario" th:action="@{/carreras/agregarComentario}" method="post">
                <h3 th:text="#{calificaCarrera}"></h3>
                <div id="star-rating" class="estrellas-seleccion">
                    <span class="estrella" th:each="i : ${#numbers.sequence(1, 5)}" th:data-value="${i}"></span>
                </div>
                <input type="hidden" id="calificacion" name="calificacion" value="0">
                <input type="hidden" id="id_carrera" name="id_carrera" th:value="${carrera.id_carrera}">
                <h3 th:text="#{dejaComentario}"></h3>
                <textarea id="comentarioNuevo" name="comentarioNuevo" rows="4" th:placeholder="#{escribeTuComentario}"></textarea>
                <button type="submit" id="enviarButton" th:text="#{publicar}"></button>
                <div id="error-messages"></div>
            </form>
        </div>

        <div class="lista-comentarios">
            <h2 th:text="#{comentarios}">Comentarios</h2>
            <div th:each="comentario : ${foros}" class="comentario">
                <img th:src="@{'/img/perfilUsuario/' + ${comentario.usuario.foto_perfil} + '.jpg'}" alt="Avatar" class="comentario-avatar">
                <div class="comentario-contenido">
                    <div class="comentario-encabezado">
                        <span class="comentario-autor" th:text="${comentario.usuario.nombre} + ' ' + ${comentario.usuario.apellidoP}"></span>
                        <span class="comentario-fecha" th:text="${#dates.format(comentario.fechaCreacion, 'dd/MM/yyyy HH:mm')}"></span>
                    </div>
                    <div class="comentario-estrellas">
                        <span th:each="i : ${#numbers.sequence(1, 5)}">
                            <svg class="estrella" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                                <path th:attr="fill=${i} <= ${comentario.calificacion} ? '#0047FF' : 'none', stroke=${i} <= ${comentario.calificacion} ? '#0047FF' : '#0047FF'"
                                d="M1.327,12.4,4.887,15,3.535,19.187A3.178,3.178,0,0,0,4.719,22.8a3.177,3.177,0,0,0,3.8-.019L12,20.219l3.482,2.559a3.227,3.227,0,0,0,4.983-3.591L19.113,15l3.56-2.6a3.227,3.227,0,0,0-1.9-5.832H16.4L15.073,2.432a3.227,3.227,0,0,0-6.146,0L7.6,6.568H3.231a3.227,3.227,0,0,0-1.9,5.832Z"/>
                            </svg>
                        </span>
                    </div>
                    <p class="comentario-texto" th:text="${comentario.comentario}"></p>
                </div>
            </div>
            <div th:if="${foros == null or #lists.isEmpty(foros)}" th:text="#{noComentarios}">
                <p>No hay comentarios aún. ¡Sé el primero en comentar!</p>
            </div>
        </div>
    </div>
</div>

<center>
    <footer class="footer">
        <div class="footer-logo">
            <img src="/css/LogoLogoPathFinderVertical.svg" alt="">
        </div>
        <div class="footer-section">
            <h3 th:text="#{servicio}"></h3>
            <a href="#" th:text="#{nuestroTrabajo}"></a>
            <a href="#" th:text="#{centroAyuda}"></a>
            <a href="#" th:text="#{faqs}"></a>
        </div>
        <div class="footer-section">
            <h3 th:text="#{contacto}"></h3>
            <p>contacto@pathfinder.com</p>
            <p th:text="#{sobreNosotros}"></p>
            <p>614 785 6594</p>
        </div>
        <div class="footer-section">
            <h3 th:text="#{direccion}"></h3>
            <p>Av. Montes Americanos #9501, Col.</p>
            <p>Sector 35, C.P. 31216, Chihuahua,</p>
            <p>Chih., México.</p>
        </div>
        <div class="footer-bottom">
            <div class="footer-links">
                <a>&copy; 2024 PathFinder</a>
                <a href="#" th:text="#{terminos}"></a>
                <a href="#" th:text="#{politica}"></a>
            </div>
            <div class="social-icons">

                <a href="#" title="Facebook"><img src="/css/assets/facebook.svg" alt=""></a>
                <a href="#" title="X"><img src="/css/assets/x.svg" alt=""></a>
                <a href="#" title="Instagram"><img src="/css/assets/instagram.svg" alt=""></a>
                <a href="#" title="LinkedIn"><img src="/css/assets/linkedin.svg" alt=""></a>
            </div>
        </div>
    </footer>
</center>

    <script src="/js/comentarioValidacion.js"></script>
</body>
</html>